<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JWT Demo</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jwt-decode/3.1.2/jwt-decode.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        .token-display {
            word-break: break-all;
            margin: 20px 0;
            padding: 10px;
            background: #f0f0f0;
        }
    </style>
</head>
<body>
    <h1>JWT Demo</h1>
    
    <div>
        <input type="hidden" id="tableNumber" value="1">
    </div>

    <div class="token-display">
        <h3>Generated Token:</h3>
        <p id="tokenOutput"></p>
    </div>

    <div>
        <h3>Decoded Token:</h3>
        <pre id="decodedOutput"></pre>
    </div>

    <script>
        function generateToken() {
            // Create the JWT payload
            const header = {
                alg: 'HS256',
                typ: 'JWT'
            };
            const payload = {
                tableNumber: document.getElementById('tableNumber').value,
                timestamp: new Date().toISOString(),
                exp: Math.floor(Date.now() / 1000) + (180 * 60) // 3 hour expiration
            };



            const encodedHeader = btoa(JSON.stringify(header));
            const encodedPayload = btoa(JSON.stringify(payload));
            const signature = 'willem-signature'; 

            // Combine the parts
            const token = `${encodedHeader}.${encodedPayload}.${signature}`;

            // Display the token
            document.getElementById('tokenOutput').textContent = token;

            // Display decoded information
            const decodedOutput = {
                header: header,
                payload: payload
            };
            document.getElementById('decodedOutput').textContent = 
                JSON.stringify(decodedOutput, null, 2);
        }
            
        function getTableNumberFromURL() {
            const urlParams = new URLSearchParams(window.location.search);
            const tableParam = urlParams.get('table');
            if (tableParam) {
                document.getElementById('tableNumber').value = tableParam;
            }
            generateToken();
        }
        window.onload = getTableNumberFromURL;
    </script>
</body>
</html>
